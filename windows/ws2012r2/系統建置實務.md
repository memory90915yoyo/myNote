# 概觀 #


## Windows 架構 ##

- workgroup

	peer-to-peer

- domain

	client / server


## 啟動 ##

開機時, 按 F8 將進入 "進階開機選單" (或是使用 bcdedit.exe)


## 關機 ##

	PS C:\Users\Administrator> logon.exe # 登出
	PS C:\Users\Administrator> shutdown.exe /s # 關機

	PS C:\Users\Administrator> Restart-Computer # 重開機
	PS C:\Users\Administrator> Stop-Computer # 關機


## 電腦名稱 ##

	PS C:\Users\Administrator> HOSTNAME.EXE # 顯示當前主機名稱

	PS C:\Users\Administrator> netdom.exe help
	PS C:\Users\Administrator> netdom.exe renamecomputer old_hostname /newname:new_hostname # 改變主機名稱


## 加入網域 ##

	PS C:\Users\Administrator> netdom.exe join machine /Domain: contoso.com /UserD:contoso\administrator /PasswordD:* # 加入網域
	PS C:\Users\Administrator> netdom.exe join machine /Domain: contoso.com /UserD:contoso\administrator /PasswordD:* /REBoot # 加入網域後自動重開機


## 網路 ##

APIPA(Automatic Private IP Addressing) 169.254.0.0/16

	PS C:\Users\Administrator> ipconfig.exe
	PS C:\Users\Administrator> ipconfig.exe /?
	PS C:\Users\Administrator> ipconfig.exe /all

	PS C:\Users\Administrator> netsh.exe /?
	PS C:\Users\Administrator> netsh.exe interface ipv4 set address ethernet0 static 192.168.0.1 255.255.255.0 192.168.0.1 # 設定 static ip
	PS C:\Users\Administrator> netsh.exe interface ipv4 set dns ethernet0 static 192.168.0.1 # 設定 dns

	PS C:\Users\Administrator> netsh.exe interface ipv4 set address ethernet0 dhcp # 設定 dynamic ip

	PS C:\Users\Administrator> PING.EXE 8.8.8.8
	PS C:\Users\Administrator> Test-Connection 8.8.8.8

	PS C:\Users\Administrator> ARP -a

	PS C:\Users\Administrator> ROUTE.EXE PRINT

	PS C:\Users\Administrator> netsh.exe firewall show
	PS C:\Users\Administrator> netsh.exe advfirewall show currentprofile


## 顯示網路芳鄰 ##

	# workgroup info
	PS C:\Users\Administrator> net.exe config workstation
	PS C:\Users\Administrator> net.exe config server

	# workgroup setup
	PS C:\Users\Administrator> wmic ComputerSystem Set Workgroup= "NewWorkGroup" # 更改 workgroup

	# NetBIOD info
	PS C:\Users\Administrator> nbtstat.exe -n # 本機 NetBIOD 設定
	PS C:\Users\Administrator> nbtstat.exe -a machine
	PS C:\Users\Administrator> nbtstat.exe -A machine

	# SMB info
	PS C:\Users\Administrator> net.exe view /all # 顯示 workgroup 中的主機
	PS C:\Users\Administrator> net.exe view machine # 顯示主機名稱 machine

	# mount/umount CIFS
	PS C:\Users\Administrator> net.exe use Z: \\machine\shered_folder # mount
	PS C:\Users\Administrator> net.exe use Z: /del # umount

	# share folder
	net share myshare=C:\Users\shared_folder



## 序號 ##

	PS C:\Users\Administrator> Dism.exe /Online /Get-CurrentEdition # 顯示當前版本
	PS C:\Users\Administrator> Dism.exe /Online /Get-TargetEditions # 可設定之版本
	PS C:\Users\Administrator> Dism.exe /online /Set-Edition:ServerStandard /ProductKey:M98WF-NY2PP-73243-PC8R6-V6B4Y /AcceptEula


## Guest 帳號 ##

	net.exe user guest /ACTIVIE:YES # 啟用 Guest 帳號
	net.exe user guest /ACTIVIE:NO # 關閉 Guest 帳號
	net.exe user guest * # 設定密碼
	net.exe user guest "" # 移除密碼

	whoami
	runas
	icacls